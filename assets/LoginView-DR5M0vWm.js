import{u as M,a as I,r as i,c as p,o as m,b as f,d as e,e as u,t as _,w as b,v as h,i as g,g as N}from"./index-BIfDqfYB.js";const P={class:"bg-light"},S={class:"container vh-100"},V={class:"row justify-content-center align-items-center h-100"},C={class:"col-auto"},q={class:"card shadow"},B={class:"card-body p-4"},D={class:"mb-4"},E=e("h5",{class:"card-title"},"Войти в личный кабинет",-1),O={class:"d-flex align-items-center flex-nowrap card-subtitle gap-1"},j=e("span",null,"или",-1),A={class:"mb-3"},F={for:"emailPhone",class:"form-label label-required"},J=e("div",{class:"invalid-feedback"}," Поле обязательно для заполнения ",-1),R={key:0,class:"mb-3"},T=e("label",{for:"password",class:"form-label label-required"},"Пароль",-1),$=e("div",{class:"invalid-feedback"}," Поле обязательно для заполнения ",-1),H={__name:"LoginView",setup(z){const v=M(),t=I();t.getUsers();let l=i("code");const d=i();let o=i(),r=i();const w=p(()=>l.value=="code"?"Email / номер телефона":"Email / номер телефона / логин"),y=p(()=>l.value=="code"?"паролю":"коду");function x(){l.value=="code"?l.value="password":l.value="code"}const c=i();function L(){if(!d.value.checkValidity())event.preventDefault(),event.stopPropagation(),d.value.classList.add("was-validated");else if(d.value.classList.add("was-validated"),l.value=="code"){console.log(t.usersList);const a=t.usersList.findIndex(s=>s.email===o.value||s.phone===o.value);if(a!=-1){const s=i("");Object.entries(t.usersList[a]).map(([k,U])=>{U===o.value&&(k=="email"?s.value="почту":s.value="телефон")}),c.value=Math.floor(Math.random()*9e3)+1e3,prompt(`Пожалуйста, введите четырехзначный код, отправленный на ${s.value} (Вот он: ${c.value})`,c.value)==c.value?(localStorage.setItem("currentUser",JSON.stringify(t.usersList[a])),t.currentUser=t.usersList[a],v.push("/")):alert("Код введен неверно")}else alert("Пользователь не наден")}else{const a=t.usersList.findIndex(s=>s.email===o.value||s.phone===o.value||s.login===o.value);a!=-1?t.usersList[a].password==r.value?(localStorage.setItem("currentUser",JSON.stringify(t.usersList[a])),t.currentUser=t.usersList[a],v.push("/")):alert("Пароль введен неверно"):alert("Пользователь не наден")}}return(a,s)=>(m(),f("main",P,[e("div",S,[e("div",V,[e("div",C,[e("div",q,[e("div",B,[e("div",D,[E,e("div",O,[j,e("button",{type:"button",class:"btn btn-link p-0 text-decoration-none",onClick:s[0]||(s[0]=n=>u(v).push("/register"))}," создать учетную запись ")])]),e("form",{ref_key:"loginForm",ref:d,class:"d-flex flex-column"},[e("div",A,[e("label",F,_(w.value),1),b(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>g(o)?o.value=n:o=n),type:"text",class:"form-control",id:"emailPhone",required:""},null,512),[[h,u(o)]]),J]),u(l)=="password"?(m(),f("div",R,[T,b(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>g(r)?r.value=n:r=n),type:"password",class:"form-control",id:"password",required:""},null,512),[[h,u(r)]]),$])):N("",!0),e("button",{type:"button",class:"btn btn-link px-0 align-self-start text-decoration-none",onClick:x}," Войти по "+_(y.value),1),e("button",{type:"button",class:"btn btn-primary my-2",onClick:L},"Продолжить")],512)])])])])])]))}};export{H as default};
